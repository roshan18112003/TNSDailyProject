<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Neon Music Player</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #0a0f1c;
      --card: #141d2f;
      --muted: #a0aec0;
      --accent: #00f2fe;
      --accent-2: #7c5cff;
      --text: #e5e7eb;
      --danger: #ef4444;
      --ok: #10b981;
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
    }

    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      color: var(--text);
      background: radial-gradient(circle at 20% 20%, #1c1c3c 0%, #0a0f1c 80%);
      background-attachment: fixed;
    }

    .card {
      background: rgba(20, 29, 47, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 18px;
      padding: 16px;
      backdrop-filter: blur(12px);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.45);
      transition: all 0.3s ease;
    }

    .card:hover {
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.6);
    }

    .title {
      font-weight: 700;
      font-size: 18px;
    }

    .muted {
      color: var(--muted);
    }

    .btn {
      background: linear-gradient(145deg, #1f2937, #111827);
      border: 1px solid rgba(255, 255, 255, 0.08);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      transition: 0.2s ease-in-out;
      font-weight: 500;
    }

    .btn:hover {
      background: linear-gradient(145deg, #2d3748, #1a202c);
      transform: translateY(-1px);
    }

    .btn.primary {
      background: linear-gradient(135deg, var(--accent-2), var(--accent));
      border: 0;
      color: #fff;
      box-shadow: 0 4px 12px rgba(124, 92, 255, 0.5);
    }

    .pill {
      background: rgba(0, 242, 254, 0.15);
      border: 1px solid rgba(0, 242, 254, 0.35);
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 12px;
      color: var(--accent);
      font-weight: 500;
      display: inline-flex;
      gap: 6px;
    }

    .track {
      background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 14px;
      padding: 10px;
      transition: all 0.2s ease;
    }

    .track:hover {
      background: rgba(124, 92, 255, 0.12);
      transform: scale(1.02);
    }

    .cover {
      border-radius: 22px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 20px 50px rgba(124, 92, 255, 0.25);
    }

    .progress {
      width: 100%;
      max-width: 680px;
    }

    .bar {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 8px;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--accent-2), var(--accent));
      outline: none;
      cursor: pointer;
    }

    .bar::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: white;
      box-shadow: 0 0 0 3px rgba(124, 92, 255, 0.6);
    }

    .time {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: var(--muted);
      margin-top: 6px;
    }

    .controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .controls .big {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: white;
      font-size: 24px;
      box-shadow: 0 0 15px rgba(124, 92, 255, 0.5);
    }

    .volume {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .vol {
      width: 160px;
    }

    .btn[aria-pressed="true"] {
      box-shadow: 0 0 8px var(--accent-2), inset 0 0 4px var(--accent-2);
      border-color: var(--accent-2);
    }

    .fav-btn {
      background: transparent;
      border: 0;
      cursor: pointer;
      font-size: 18px;
      transition: transform 0.2s ease;
    }

    .fav-btn:hover {
      transform: scale(1.2);
    }

    .chips .btn {
      background: #1c2438;
      color: var(--accent);
      font-weight: 500;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.06);
    }

    .chips .btn:hover {
      background: var(--accent-2);
      color: #fff;
    }

    input.input {
      background: #121a2f;
      border: 1px solid rgba(255, 255, 255, 0.07);
      color: var(--text);
      border-radius: 12px;
      padding: 12px;
      width: 100%;
    }

    input.input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(124, 92, 255, 0.3);
      outline: none;
    }

    .footer-note {
      font-size: 12px;
      color: var(--muted);
      text-align: center;
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="card sidebar">
      <div class="row">
        <div class="title">Playlist</div>
        <div class="space"></div>
        <span class="pill" id="visitor-pill">üëã Visitors: <strong id="visitorCount">0</strong></span>
      </div>
      <div class="search">
        <div class="mic">
          <input id="search" class="input" placeholder="Search songs by name or artist" />
          <button class="btn icon" id="voiceBtn" title="Voice Search (Speech)">üéôÔ∏è</button>
        </div>
        <div class="chips" style="margin-top:10px">
          <button class="btn" id="showAll" aria-pressed="true">All</button>
          <button class="btn" id="showFav">Favorites</button>
          <button class="btn" id="showRecent">Recently Played</button>
        </div>
      </div>
      <div id="tracks" class="list" aria-live="polite"></div>
    </aside>

    <!-- Player -->
    <main class="card player-card">
      <img id="cover" class="cover" alt="Album cover" src="https://picsum.photos/600?grayscale&random=11" />
      <div class="now">
        <div class="song" id="nowSong">‚Äî</div>
        <div class="artist" id="nowArtist">‚Äî</div>
        <div class="row" style="justify-content:center; gap:8px;">
          <button class="btn" id="favNow" title="Toggle Favorite">‚ù§Ô∏è Add to Favorites</button>
          <span class="pill" id="nowBadge">Now Playing</span>
        </div>
      </div>

      <div class="progress">
        <input id="seek" class="bar" type="range" min="0" max="100" value="0" />
        <div class="time"><span id="current">0:00</span><span id="duration">0:00</span></div>
      </div>

      <div class="row controls">
        <button class="btn icon" id="shuffle" title="Shuffle">üîÄ</button>
        <button class="btn icon" id="prev" title="Previous">‚èÆÔ∏è</button>
        <button class="btn primary big" id="play">‚ñ∂Ô∏è</button>
        <button class="btn icon" id="next" title="Next">‚è≠Ô∏è</button>
        <button class="btn icon" id="repeat" title="Repeat">üîÅ</button>
        <div class="space"></div>
        <div class="volume">
          <span>üîä</span>
          <input id="volume" class="bar vol" type="range" min="0" max="1" step="0.01" value="1" />
        </div>
      </div>

      <audio id="audio" preload="metadata"></audio>
      <div class="footer-note">Tip: Use keyboard ‚èÆ J / K ‚èØ / L ‚è≠, ‚Üë/‚Üì volume.</div>
    </main>

    <!-- Right Column -->
    <aside class="card right">
      <div class="section">
        <div class="title">Favorites</div>
        <div id="favList" class="small-list" aria-live="polite"></div>
      </div>
      <div class="section">
        <div class="title">Recently Played</div>
        <div id="recentList" class="small-list" aria-live="polite"></div>
      </div>
    </aside>
  </div>

  <!-- Songs Data + Script -->
  <script id="songs-data" type="application/json">
    {
      "songs": [
        {"id":1, "title":"Tum ho toh", "artist":"Vishal Mishra", "url":"songs/song1.mp3", "cover":"images/pic1.jpg"},
        {"id":2, "title":"SoundHelix Song 2", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3", "cover":"https://picsum.photos/id/1027/600/600"},
        {"id":3, "title":"SoundHelix Song 3", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3", "cover":"https://picsum.photos/id/1025/600/600"},
        {"id":4, "title":"SoundHelix Song 4", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3", "cover":"https://picsum.photos/id/1035/600/600"},
        {"id":5, "title":"SoundHelix Song 5", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3", "cover":"https://picsum.photos/id/1049/600/600"},
        {"id":6, "title":"SoundHelix Song 6", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3", "cover":"https://picsum.photos/id/1050/600/600"},
        {"id":7, "title":"SoundHelix Song 7", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-7.mp3", "cover":"https://picsum.photos/id/1062/600/600"},
        {"id":8, "title":"SoundHelix Song 8", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3", "cover":"https://picsum.photos/id/1069/600/600"},
        {"id":9, "title":"SoundHelix Song 9", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-9.mp3", "cover":"https://picsum.photos/id/1074/600/600"},
        {"id":10, "title":"SoundHelix Song 10", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3", "cover":"https://picsum.photos/id/1084/600/600"},
        {"id":11, "title":"SoundHelix Song 11", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-11.mp3", "cover":"https://picsum.photos/id/1080/600/600"},
        {"id":12, "title":"SoundHelix Song 12", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-12.mp3", "cover":"https://picsum.photos/id/109/600/600"},
        {"id":13, "title":"SoundHelix Song 1", "artist":"T. Sch√ºrger", "url":"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3", "cover":"https://picsum.photos/id/1011/600/600"}
      ]
    }
  </script>

  <script>
    // ===== Your existing JavaScript code starts here =====
    const $ = (sel, ctx = document) => ctx.querySelector(sel);
    const $$ = (sel, ctx = document) => Array.from(ctx.querySelectorAll(sel));
    const fmt = s => isNaN(s) ? '0:00' : `${Math.floor(s / 60)}:${String(Math.floor(s % 60)).padStart(2, '0')}`;

    const store = {
      get(k, def) { try { return JSON.parse(localStorage.getItem(k)) ?? def } catch { return def } },
      set(k, v) { localStorage.setItem(k, JSON.stringify(v)); }
    };

    const data = JSON.parse(document.getElementById('songs-data').textContent);
    let songs = data.songs;
    let index = store.get('mp_lastIndex', 0);
    let favorites = new Set(store.get('mp_favorites', []));
    let recent = store.get('mp_recent', []);
    let shuffleOn = !!store.get('mp_shuffle', false);
    let repeatOn = !!store.get('mp_repeat', false);

    const visits = (store.get('mp_visitorCount', 0) || 0) + 1; store.set('mp_visitorCount', visits);
    document.getElementById('visitorCount').textContent = visits;

    const audio = document.getElementById('audio');
    const cover = document.getElementById('cover');
    const nowSong = document.getElementById('nowSong');
    const nowArtist = document.getElementById('nowArtist');
    const favNow = document.getElementById('favNow');
    const seek = document.getElementById('seek');
    const current = document.getElementById('current');
    const duration = document.getElementById('duration');
    const volume = document.getElementById('volume');
    const playBtn = document.getElementById('play');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');
    const shuffleBtn = document.getElementById('shuffle');
    const repeatBtn = document.getElementById('repeat');
    const tracksEl = document.getElementById('tracks');
    const favList = document.getElementById('favList');
    const recentList = document.getElementById('recentList');
    const search = document.getElementById('search');
    const voiceBtn = document.getElementById('voiceBtn');

    function renderList(filter = "all") {
      tracksEl.innerHTML = '';
      let items = songs;
      if (filter === 'fav') items = songs.filter(s => favorites.has(s.id));
      if (filter === 'recent') items = recent.map(id => songs.find(s => s.id === id)).filter(Boolean);
      const q = search.value.trim().toLowerCase();
      if (q) { items = items.filter(s => s.title.toLowerCase().includes(q) || s.artist.toLowerCase().includes(q)); }
      items.forEach((s, i) => tracksEl.appendChild(renderTrack(s)));
      if (items.length === 0) {
        const empty = document.createElement('div');
        empty.className = 'muted'; empty.style.padding = '20px'; empty.textContent = 'No songs match your filter/search.';
        tracksEl.appendChild(empty);
      }
    }

    function renderTrack(s) {
      const el = document.createElement('div'); el.className = 'track'; el.setAttribute('data-id', s.id);
      el.innerHTML = `
        <img class="thumb" src="${s.cover}" alt="${s.title} album"/>
        <div class="meta">
          <span class="title">${s.title}</span>
          <span class="artist">${s.artist}</span>
        </div>
        <button class="fav-btn" title="Toggle Favorite" aria-label="favorite">${favorites.has(s.id) ? '‚ù§Ô∏è' : 'ü§ç'}</button>
      `;
      el.addEventListener('click', (e) => {
        if (e.target.closest('.fav-btn')) return;
        playById(s.id);
      });
      el.querySelector('.fav-btn').addEventListener('click', () => toggleFavorite(s.id));
      return el;
    }

    function renderSideLists() {
      favList.innerHTML = '';
      songs.filter(s => favorites.has(s.id)).forEach(s => {
        const i = document.createElement('div'); i.className = 'small-item';
        i.innerHTML = `<img src="${s.cover}" alt=""/><div class="label"><div>${s.title}</div><div class="muted">${s.artist}</div></div>`;
        i.addEventListener('click', () => playById(s.id));
        favList.appendChild(i);
      });
      if (!favList.childElementCount) favList.innerHTML = '<div class="muted">No favorites yet.</div>';

      recentList.innerHTML = '';
      recent.forEach(id => {
        const s = songs.find(x => x.id === id); if (!s) return;
        const i = document.createElement('div'); i.className = 'small-item';
        i.innerHTML = `<img src="${s.cover}" alt=""/><div class="label"><div>${s.title}</div><div class="muted">${s.artist}</div></div>`;
        i.addEventListener('click', () => playById(s.id));
        recentList.appendChild(i);
      });
      if (!recentList.childElementCount) recentList.innerHTML = '<div class="muted">Nothing played yet.</div>';
    }

    function load(i) {
      index = (i + songs.length) % songs.length; store.set('mp_lastIndex', index);
      const s = songs[index];
      audio.src = s.url; audio.load();
      cover.src = s.cover; nowSong.textContent = s.title; nowArtist.textContent = s.artist;
      favNow.textContent = favorites.has(s.id) ? 'üíî Remove Favorite' : '‚ù§Ô∏è Add to Favorites';
      document.getElementById('nowBadge').textContent = 'Now Playing';
    }

    async function play() { await audio.play(); playBtn.textContent = '‚è∏Ô∏è'; }
    function pause() { audio.pause(); playBtn.textContent = '‚ñ∂Ô∏è'; }

    function playById(id) { const i = songs.findIndex(s => s.id === id); if (i >= 0) { load(i); play(); pushRecent(id); highlightCurrent(); } }

    function pushRecent(id) {
      recent = [id, ...recent.filter(x => x !== id)].slice(0, 12); store.set('mp_recent', recent); renderSideLists();
    }

    function next() {
      if (shuffleOn) {
        let rnd;
        do { rnd = Math.floor(Math.random() * songs.length); }
        while (songs[rnd].id === songs[index].id && songs.length > 1);
        load(rnd);
      } else {
        load(index + 1);
      }
      play(); highlightCurrent();
    }

    function prev() { load(index - 1); play(); highlightCurrent(); }

    function toggleFavorite(id) {
      if (favorites.has(id)) favorites.delete(id); else favorites.add(id);
      store.set('mp_favorites', Array.from(favorites));
      favNow.textContent = favorites.has(songs[index].id) ? 'üíî Remove Favorite' : '‚ù§Ô∏è Add to Favorites';
      renderList(activeFilter); renderSideLists();
    }

    audio.addEventListener('timeupdate', () => {
      seek.value = (audio.currentTime / (audio.duration || 1)) * 100;
      current.textContent = fmt(audio.currentTime);
      duration.textContent = fmt(audio.duration);
    });

    audio.addEventListener('ended', () => {
      if (repeatOn) { audio.currentTime = 0; play(); return; }
      next();
    });

    seek.addEventListener('input', () => {
      audio.currentTime = (seek.value / 100) * (audio.duration || 0);
    });

    const lastVol = store.get('mp_volume', 0.9); audio.volume = lastVol; volume.value = lastVol;
    volume.addEventListener('input', () => { audio.volume = Number(volume.value); store.set('mp_volume', Number(volume.value)); });

    playBtn.addEventListener('click', () => audio.paused ? play() : pause());
    prevBtn.addEventListener('click', prev);
    nextBtn.addEventListener('click', next);

    shuffleBtn.addEventListener('click', () => { shuffleOn = !shuffleOn; store.set('mp_shuffle', shuffleOn); shuffleBtn.setAttribute('aria-pressed', shuffleOn); });
    repeatBtn.addEventListener('click', () => { repeatOn = !repeatOn; store.set('mp_repeat', repeatOn); repeatBtn.setAttribute('aria-pressed', repeatOn); });

    favNow.addEventListener('click', () => toggleFavorite(songs[index].id));

    window.addEventListener('keydown', (e) => {
      if (['INPUT', 'TEXTAREA'].includes(e.target.tagName)) return;
      if (e.key === 'k' || e.code === 'Space') { e.preventDefault(); audio.paused ? play() : pause();}
      if (e.key === 'j') prev();
      if (e.key === 'l') next();
      if (e.key === 'ArrowUp') { audio.volume = Math.min(1, audio.volume + .05); volume.value = audio.volume; store.set('mp_volume', audio.volume);}
      if (e.key === 'ArrowDown') { audio.volume = Math.max(0, audio.volume - .05); volume.value = audio.volume; store.set('mp_volume', audio.volume);}
    });

    let activeFilter = 'all';
    document.getElementById('showAll').addEventListener('click', () => setFilter('all'));
    document.getElementById('showFav').addEventListener('click', () => setFilter('fav'));
    document.getElementById('showRecent').addEventListener('click', () => setFilter('recent'));
    function setFilter(f) {
      activeFilter = f;
      $$('.chips .btn').forEach(b => b.setAttribute('aria-pressed', 'false'));
      $('#showAll').setAttribute('aria-pressed', f === 'all');
      $('#showFav').setAttribute('aria-pressed', f === 'fav');
      $('#showRecent').setAttribute('aria-pressed', f === 'recent');
      renderList(activeFilter);
    }
    search.addEventListener('input', () => renderList(activeFilter));

    voiceBtn.addEventListener('click', () => {
      const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SR) { alert('Speech Recognition not supported'); return; }
      const rec = new SR(); rec.lang = 'en-IN'; rec.interimResults = false; rec.maxAlternatives = 1;
      voiceBtn.textContent = 'üé§'; voiceBtn.disabled = true;
      rec.onresult = ev => { search.value = ev.results[0][0].transcript; renderList(activeFilter); voiceBtn.textContent = 'üéôÔ∏è'; voiceBtn.disabled = false; };
      rec.onerror = () => { voiceBtn.textContent = 'üéôÔ∏è'; voiceBtn.disabled = false; };
      rec.onend = () => { voiceBtn.textContent = 'üéôÔ∏è'; voiceBtn.disabled = false; };
      rec.start();
    });

    function highlightCurrent() {
      const id = songs[index].id;
      $$('.track').forEach(el => el.style.outline = 'none');
      const active = $(`.track[data-id="${id}"]`);
      if (active) {
        active.style.outline = `2px solid ${getComputedStyle(document.documentElement).getPropertyValue('--accent')}`;
        active.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
      }
    }

    renderList(); renderSideLists(); load(index); highlightCurrent();
  </script>
</body>
</html>
